# Generated by Django 5.2.3 on 2025-07-14 15:37

import django.db.models.deletion
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('companies', '0001_initial'),
        ('sri_integration', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='sriconfiguration',
            name='purchase_settlement_sequence',
            field=models.PositiveIntegerField(default=1, help_text='Current purchase settlement sequence number', verbose_name='purchase settlement sequence'),
        ),
        migrations.AlterField(
            model_name='electronicdocument',
            name='document_type',
            field=models.CharField(choices=[('INVOICE', 'Invoice'), ('CREDIT_NOTE', 'Credit Note'), ('DEBIT_NOTE', 'Debit Note'), ('RETENTION', 'Retention'), ('REMISSION_GUIDE', 'Remission Guide'), ('PURCHASE_SETTLEMENT', 'Purchase Settlement')], max_length=20, verbose_name='document type'),
        ),
        migrations.CreateModel(
            name='PurchaseSettlement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Date and time when the record was created.', verbose_name='created at')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Date and time when the record was last updated.', verbose_name='updated at')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this record should be treated as active.', verbose_name='is active')),
                ('document_number', models.CharField(max_length=17, verbose_name='document number')),
                ('access_key', models.CharField(max_length=49, unique=True, verbose_name='access key')),
                ('issue_date', models.DateField(verbose_name='issue date')),
                ('supplier_identification_type', models.CharField(max_length=2, verbose_name='supplier identification type')),
                ('supplier_identification', models.CharField(max_length=20, verbose_name='supplier identification')),
                ('supplier_name', models.CharField(max_length=300, verbose_name='supplier name')),
                ('supplier_address', models.TextField(blank=True, verbose_name='supplier address')),
                ('subtotal_without_tax', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='subtotal without tax')),
                ('total_tax', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='total tax')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='total amount')),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('GENERATED', 'Generated'), ('SIGNED', 'Signed'), ('SENT', 'Sent to SRI'), ('AUTHORIZED', 'Authorized'), ('REJECTED', 'Rejected'), ('ERROR', 'Error')], default='DRAFT', max_length=20, verbose_name='status')),
                ('xml_file', models.FileField(blank=True, upload_to='settlements/xml/', verbose_name='XML file')),
                ('signed_xml_file', models.FileField(blank=True, upload_to='settlements/xml/', verbose_name='signed XML file')),
                ('pdf_file', models.FileField(blank=True, upload_to='settlements/pdf/', verbose_name='PDF file')),
                ('sri_authorization_code', models.CharField(blank=True, max_length=49, verbose_name='SRI authorization code')),
                ('sri_authorization_date', models.DateTimeField(blank=True, null=True, verbose_name='SRI authorization date')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='purchase_settlements', to='companies.company')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='created by')),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='updated by')),
            ],
            options={
                'verbose_name': 'Purchase Settlement',
                'verbose_name_plural': 'Purchase Settlements',
                'unique_together': {('company', 'document_number')},
            },
        ),
        migrations.CreateModel(
            name='PurchaseSettlementItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Date and time when the record was created.', verbose_name='created at')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Date and time when the record was last updated.', verbose_name='updated at')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this record should be treated as active.', verbose_name='is active')),
                ('main_code', models.CharField(max_length=25, verbose_name='main code')),
                ('description', models.TextField(verbose_name='description')),
                ('quantity', models.DecimalField(decimal_places=6, max_digits=12, verbose_name='quantity')),
                ('unit_price', models.DecimalField(decimal_places=6, max_digits=12, verbose_name='unit price')),
                ('discount', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='discount')),
                ('subtotal', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='subtotal')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='created by')),
                ('settlement', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='sri_integration.purchasesettlement')),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='updated by')),
            ],
            options={
                'verbose_name': 'Purchase Settlement Item',
                'verbose_name_plural': 'Purchase Settlement Items',
            },
        ),
        migrations.CreateModel(
            name='Retention',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Date and time when the record was created.', verbose_name='created at')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Date and time when the record was last updated.', verbose_name='updated at')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this record should be treated as active.', verbose_name='is active')),
                ('document_number', models.CharField(max_length=17, verbose_name='document number')),
                ('access_key', models.CharField(max_length=49, unique=True, verbose_name='access key')),
                ('issue_date', models.DateField(verbose_name='issue date')),
                ('supplier_identification_type', models.CharField(max_length=2, verbose_name='supplier identification type')),
                ('supplier_identification', models.CharField(max_length=20, verbose_name='supplier identification')),
                ('supplier_name', models.CharField(max_length=300, verbose_name='supplier name')),
                ('supplier_address', models.TextField(blank=True, verbose_name='supplier address')),
                ('fiscal_period', models.CharField(help_text='MM/YYYY format', max_length=7, verbose_name='fiscal period')),
                ('total_retained', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='total retained')),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('GENERATED', 'Generated'), ('SIGNED', 'Signed'), ('SENT', 'Sent to SRI'), ('AUTHORIZED', 'Authorized'), ('REJECTED', 'Rejected'), ('ERROR', 'Error')], default='DRAFT', max_length=20, verbose_name='status')),
                ('xml_file', models.FileField(blank=True, upload_to='retentions/xml/', verbose_name='XML file')),
                ('signed_xml_file', models.FileField(blank=True, upload_to='retentions/xml/', verbose_name='signed XML file')),
                ('pdf_file', models.FileField(blank=True, upload_to='retentions/pdf/', verbose_name='PDF file')),
                ('sri_authorization_code', models.CharField(blank=True, max_length=49, verbose_name='SRI authorization code')),
                ('sri_authorization_date', models.DateTimeField(blank=True, null=True, verbose_name='SRI authorization date')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='retentions', to='companies.company')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='created by')),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='updated by')),
            ],
            options={
                'verbose_name': 'Retention',
                'verbose_name_plural': 'Retentions',
                'unique_together': {('company', 'document_number')},
            },
        ),
        migrations.CreateModel(
            name='RetentionDetail',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Date and time when the record was created.', verbose_name='created at')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Date and time when the record was last updated.', verbose_name='updated at')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this record should be treated as active.', verbose_name='is active')),
                ('support_document_type', models.CharField(max_length=2, verbose_name='support document type')),
                ('support_document_number', models.CharField(max_length=20, verbose_name='support document number')),
                ('support_document_date', models.DateField(verbose_name='support document date')),
                ('tax_code', models.CharField(max_length=4, verbose_name='tax code')),
                ('retention_code', models.CharField(max_length=5, verbose_name='retention code')),
                ('retention_percentage', models.DecimalField(decimal_places=2, max_digits=5, verbose_name='retention percentage')),
                ('taxable_base', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='taxable base')),
                ('retained_amount', models.DecimalField(decimal_places=2, max_digits=12, verbose_name='retained amount')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='created by')),
                ('retention', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='sri_integration.retention')),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='updated by')),
            ],
            options={
                'verbose_name': 'Retention Detail',
                'verbose_name_plural': 'Retention Details',
            },
        ),
        migrations.CreateModel(
            name='CreditNote',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Date and time when the record was created.', verbose_name='created at')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Date and time when the record was last updated.', verbose_name='updated at')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this record should be treated as active.', verbose_name='is active')),
                ('document_number', models.CharField(help_text='Format: 001-001-000000001', max_length=17, verbose_name='document number')),
                ('access_key', models.CharField(help_text='49-digit access key', max_length=49, unique=True, verbose_name='access key')),
                ('issue_date', models.DateField(verbose_name='issue date')),
                ('reason_code', models.CharField(choices=[('01', 'Devoluci贸n de bienes'), ('02', 'Anulaci贸n de venta'), ('03', 'Descuento otorgado'), ('04', 'Bonificaci贸n'), ('05', 'Devoluci贸n en compras'), ('06', 'Descuento por pronto pago'), ('07', 'Otros')], default='07', max_length=2, verbose_name='reason code')),
                ('reason_description', models.TextField(help_text='Detailed reason for credit note', max_length=300, verbose_name='reason description')),
                ('customer_identification_type', models.CharField(max_length=2, verbose_name='customer identification type')),
                ('customer_identification', models.CharField(max_length=20, verbose_name='customer identification')),
                ('customer_name', models.CharField(max_length=300, verbose_name='customer name')),
                ('customer_address', models.TextField(blank=True, verbose_name='customer address')),
                ('customer_email', models.EmailField(blank=True, max_length=254, verbose_name='customer email')),
                ('subtotal_without_tax', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='subtotal without tax')),
                ('total_tax', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='total tax')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='total amount')),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('GENERATED', 'Generated'), ('SIGNED', 'Signed'), ('SENT', 'Sent to SRI'), ('AUTHORIZED', 'Authorized'), ('REJECTED', 'Rejected'), ('ERROR', 'Error')], default='DRAFT', max_length=20, verbose_name='status')),
                ('xml_file', models.FileField(blank=True, upload_to='credit_notes/xml/', verbose_name='XML file')),
                ('signed_xml_file', models.FileField(blank=True, upload_to='credit_notes/xml/', verbose_name='signed XML file')),
                ('pdf_file', models.FileField(blank=True, upload_to='credit_notes/pdf/', verbose_name='PDF file')),
                ('sri_authorization_code', models.CharField(blank=True, max_length=49, verbose_name='SRI authorization code')),
                ('sri_authorization_date', models.DateTimeField(blank=True, null=True, verbose_name='SRI authorization date')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='credit_notes', to='companies.company', verbose_name='company')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='created by')),
                ('original_document', models.ForeignKey(help_text='Invoice or document being credited', on_delete=django.db.models.deletion.CASCADE, related_name='credit_notes', to='sri_integration.electronicdocument', verbose_name='original document')),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='updated by')),
            ],
            options={
                'verbose_name': 'Credit Note',
                'verbose_name_plural': 'Credit Notes',
                'unique_together': {('company', 'document_number')},
            },
        ),
        migrations.CreateModel(
            name='DebitNote',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='Date and time when the record was created.', verbose_name='created at')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='Date and time when the record was last updated.', verbose_name='updated at')),
                ('is_active', models.BooleanField(default=True, help_text='Designates whether this record should be treated as active.', verbose_name='is active')),
                ('document_number', models.CharField(max_length=17, verbose_name='document number')),
                ('access_key', models.CharField(max_length=49, unique=True, verbose_name='access key')),
                ('issue_date', models.DateField(verbose_name='issue date')),
                ('reason_code', models.CharField(choices=[('01', 'Intereses de mora'), ('02', 'Gastos de cobranza'), ('03', 'Gastos de transporte'), ('04', 'Otros gastos'), ('05', 'Aumento en el precio')], max_length=2, verbose_name='reason code')),
                ('reason_description', models.TextField(max_length=300, verbose_name='reason description')),
                ('customer_identification_type', models.CharField(max_length=2, verbose_name='customer identification type')),
                ('customer_identification', models.CharField(max_length=20, verbose_name='customer identification')),
                ('customer_name', models.CharField(max_length=300, verbose_name='customer name')),
                ('customer_address', models.TextField(blank=True, verbose_name='customer address')),
                ('customer_email', models.EmailField(blank=True, max_length=254, verbose_name='customer email')),
                ('subtotal_without_tax', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='subtotal without tax')),
                ('total_tax', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='total tax')),
                ('total_amount', models.DecimalField(decimal_places=2, default=0, max_digits=12, verbose_name='total amount')),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('GENERATED', 'Generated'), ('SIGNED', 'Signed'), ('SENT', 'Sent to SRI'), ('AUTHORIZED', 'Authorized'), ('REJECTED', 'Rejected'), ('ERROR', 'Error')], default='DRAFT', max_length=20, verbose_name='status')),
                ('xml_file', models.FileField(blank=True, upload_to='debit_notes/xml/', verbose_name='XML file')),
                ('signed_xml_file', models.FileField(blank=True, upload_to='debit_notes/xml/', verbose_name='signed XML file')),
                ('pdf_file', models.FileField(blank=True, upload_to='debit_notes/pdf/', verbose_name='PDF file')),
                ('sri_authorization_code', models.CharField(blank=True, max_length=49, verbose_name='SRI authorization code')),
                ('sri_authorization_date', models.DateTimeField(blank=True, null=True, verbose_name='SRI authorization date')),
                ('company', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='debit_notes', to='companies.company')),
                ('created_by', models.ForeignKey(blank=True, help_text='User who created this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_created', to=settings.AUTH_USER_MODEL, verbose_name='created by')),
                ('original_document', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='debit_notes', to='sri_integration.electronicdocument', verbose_name='original document')),
                ('updated_by', models.ForeignKey(blank=True, help_text='User who last updated this record.', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(class)s_updated', to=settings.AUTH_USER_MODEL, verbose_name='updated by')),
            ],
            options={
                'verbose_name': 'Debit Note',
                'verbose_name_plural': 'Debit Notes',
                'unique_together': {('company', 'document_number')},
            },
        ),
    ]
